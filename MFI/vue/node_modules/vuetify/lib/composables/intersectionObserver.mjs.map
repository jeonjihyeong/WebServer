{"version":3,"file":"intersectionObserver.mjs","names":["onBeforeUnmount","ref","watch","SUPPORTS_INTERSECTION","useIntersectionObserver","callback","intersectionRef","isIntersecting","observer","IntersectionObserver","entries","value","find","entry","disconnect","newValue","oldValue","unobserve","observe","flush"],"sources":["../../src/composables/intersectionObserver.ts"],"sourcesContent":["// Utilities\nimport { onBeforeUnmount, ref, watch } from 'vue'\nimport { SUPPORTS_INTERSECTION } from '@/util'\n\nexport function useIntersectionObserver (callback?: IntersectionObserverCallback) {\n  const intersectionRef = ref<HTMLElement>()\n  const isIntersecting = ref(false)\n\n  if (SUPPORTS_INTERSECTION) {\n    const observer = new IntersectionObserver((entries: IntersectionObserverEntry[]) => {\n      callback?.(entries, observer)\n\n      isIntersecting.value = !!entries.find(entry => entry.isIntersecting)\n    })\n\n    onBeforeUnmount(() => {\n      observer.disconnect()\n    })\n\n    watch(intersectionRef, (newValue, oldValue) => {\n      if (oldValue) {\n        observer.unobserve(oldValue)\n        isIntersecting.value = false\n      }\n\n      if (newValue) observer.observe(newValue)\n    }, {\n      flush: 'post',\n    })\n  }\n\n  return { intersectionRef, isIntersecting }\n}\n"],"mappings":"AAAA;AACA,SAASA,eAAT,EAA0BC,GAA1B,EAA+BC,KAA/B,QAA4C,KAA5C;SACSC,qB;AAET,OAAO,SAASC,uBAAT,CAAkCC,QAAlC,EAA2E;EAChF,MAAMC,eAAe,GAAGL,GAAG,EAA3B;EACA,MAAMM,cAAc,GAAGN,GAAG,CAAC,KAAD,CAA1B;;EAEA,IAAIE,qBAAJ,EAA2B;IACzB,MAAMK,QAAQ,GAAG,IAAIC,oBAAJ,CAA0BC,OAAD,IAA0C;MAClFL,QAAQ,QAAR,YAAAA,QAAQ,CAAGK,OAAH,EAAYF,QAAZ,CAAR;MAEAD,cAAc,CAACI,KAAf,GAAuB,CAAC,CAACD,OAAO,CAACE,IAAR,CAAaC,KAAK,IAAIA,KAAK,CAACN,cAA5B,CAAzB;IACD,CAJgB,CAAjB;IAMAP,eAAe,CAAC,MAAM;MACpBQ,QAAQ,CAACM,UAAT;IACD,CAFc,CAAf;IAIAZ,KAAK,CAACI,eAAD,EAAkB,CAACS,QAAD,EAAWC,QAAX,KAAwB;MAC7C,IAAIA,QAAJ,EAAc;QACZR,QAAQ,CAACS,SAAT,CAAmBD,QAAnB;QACAT,cAAc,CAACI,KAAf,GAAuB,KAAvB;MACD;;MAED,IAAII,QAAJ,EAAcP,QAAQ,CAACU,OAAT,CAAiBH,QAAjB;IACf,CAPI,EAOF;MACDI,KAAK,EAAE;IADN,CAPE,CAAL;EAUD;;EAED,OAAO;IAAEb,eAAF;IAAmBC;EAAnB,CAAP;AACD"}