{"version":3,"file":"VRangeSlider.mjs","names":["getOffset","makeSliderProps","useSlider","filterInputProps","makeVInputProps","VInput","VSliderThumb","VSliderTrack","makeFocusProps","useFocus","useProxiedModel","computed","ref","defineComponent","useRender","VRangeSlider","name","props","strict","Boolean","modelValue","type","Array","default","emits","value","setup","slots","startThumbRef","stopThumbRef","inputRef","getActiveThumb","e","startOffset","$el","direction","stopOffset","a","Math","abs","b","activeThumbRef","hasLabels","max","min","mousePressed","onSliderMousedown","onSliderTouchstart","position","roundValue","trackContainerRef","handleSliderMouseUp","newValue","model","handleMouseMove","start","stop","focus","undefined","arr","length","map","isFocused","blur","trackStart","trackStop","inputProps","_","disabled","id","readonly","v","relatedTarget"],"sources":["../../../src/components/VRangeSlider/VRangeSlider.tsx"],"sourcesContent":["// Styles\nimport '../VSlider/VSlider.sass'\n\n// Components\nimport { getOffset, makeSliderProps, useSlider } from '@/components/VSlider/slider'\nimport { filterInputProps, makeVInputProps, VInput } from '@/components/VInput/VInput'\nimport { VSliderThumb } from '../VSlider/VSliderThumb'\nimport { VSliderTrack } from '../VSlider/VSliderTrack'\n\n// Composables\nimport { makeFocusProps, useFocus } from '@/composables/focus'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, ref } from 'vue'\nimport { defineComponent, useRender } from '@/util'\n\n// Types\nimport type { PropType, WritableComputedRef } from 'vue'\n\nexport const VRangeSlider = defineComponent({\n  name: 'VRangeSlider',\n\n  props: {\n    ...makeFocusProps(),\n    ...makeVInputProps(),\n    ...makeSliderProps(),\n\n    strict: Boolean,\n    modelValue: {\n      type: Array as PropType<number[]>,\n      default: () => ([0, 0]),\n    },\n  },\n\n  emits: {\n    'update:focused': (value: boolean) => true,\n    'update:modelValue': (value: [number, number]) => true,\n  },\n\n  setup (props, { slots }) {\n    const startThumbRef = ref<VSliderThumb>()\n    const stopThumbRef = ref<VSliderThumb>()\n    const inputRef = ref<VInput>()\n\n    function getActiveThumb (e: MouseEvent | TouchEvent) {\n      if (!startThumbRef.value || !stopThumbRef.value) return\n\n      const startOffset = getOffset(e, startThumbRef.value.$el, props.direction)\n      const stopOffset = getOffset(e, stopThumbRef.value.$el, props.direction)\n\n      const a = Math.abs(startOffset)\n      const b = Math.abs(stopOffset)\n\n      return (a < b || (a === b && startOffset < 0)) ? startThumbRef.value.$el : stopThumbRef.value.$el\n    }\n\n    const {\n      activeThumbRef,\n      hasLabels,\n      max,\n      min,\n      mousePressed,\n      onSliderMousedown,\n      onSliderTouchstart,\n      position,\n      roundValue,\n      trackContainerRef,\n    } = useSlider({\n      /* eslint-disable @typescript-eslint/no-use-before-define */\n      props,\n      handleSliderMouseUp: newValue => {\n        model.value = activeThumbRef.value === startThumbRef.value?.$el ? [newValue, model.value[1]] : [model.value[0], newValue]\n      },\n      handleMouseMove: newValue => {\n        const [start, stop] = model.value\n\n        if (!props.strict && start === stop && start !== min.value) {\n          activeThumbRef.value = newValue > start ? stopThumbRef.value?.$el : startThumbRef.value?.$el\n          activeThumbRef.value?.focus()\n        }\n\n        if (activeThumbRef.value === startThumbRef.value?.$el) {\n          model.value = [Math.min(newValue, stop), stop]\n        } else {\n          model.value = [start, Math.max(start, newValue)]\n        }\n      },\n      getActiveThumb,\n      /* eslint-enable @typescript-eslint/no-use-before-define */\n    })\n\n    const model = useProxiedModel(\n      props,\n      'modelValue',\n      undefined,\n      arr => {\n        if (!arr || !arr.length) return [0, 0]\n\n        return arr.map(value => roundValue(value))\n      },\n    ) as WritableComputedRef<[number, number]>\n\n    const { isFocused, focus, blur } = useFocus(props)\n    const trackStart = computed(() => position(model.value[0]))\n    const trackStop = computed(() => position(model.value[1]))\n\n    useRender(() => {\n      const [inputProps, _] = filterInputProps(props)\n\n      return (\n        <VInput\n          class={[\n            'v-slider',\n            'v-range-slider',\n            {\n              'v-slider--has-labels': !!slots['tick-label'] || hasLabels.value,\n              'v-slider--focused': isFocused.value,\n              'v-slider--pressed': mousePressed.value,\n              'v-slider--disabled': props.disabled,\n            },\n          ]}\n          ref={ inputRef }\n          { ...inputProps }\n          focused={ isFocused.value }\n        >\n          {{\n            ...slots,\n            default: ({ id }) => (\n              <div\n                class=\"v-slider__container\"\n                onMousedown={ onSliderMousedown }\n                onTouchstartPassive={ onSliderTouchstart }\n              >\n                <input\n                  id={ `${id.value}_start` }\n                  name={ props.name || id.value }\n                  disabled={ props.disabled }\n                  readonly={ props.readonly }\n                  tabindex=\"-1\"\n                  value={ model.value[0] }\n                />\n\n                <input\n                  id={ `${id.value}_stop` }\n                  name={ props.name || id.value }\n                  disabled={ props.disabled }\n                  readonly={ props.readonly }\n                  tabindex=\"-1\"\n                  value={ model.value[1] }\n                />\n\n                <VSliderTrack\n                  ref={ trackContainerRef }\n                  start={ trackStart.value }\n                  stop={ trackStop.value }\n                >\n                  {{ 'tick-label': slots['tick-label'] }}\n                </VSliderTrack>\n\n                <VSliderThumb\n                  ref={ startThumbRef }\n                  focused={ isFocused && activeThumbRef.value === startThumbRef.value?.$el }\n                  modelValue={ model.value[0] }\n                  onUpdate:modelValue={ v => (model.value = [v, model.value[1]]) }\n                  onFocus={ (e: FocusEvent) => {\n                    focus()\n                    activeThumbRef.value = startThumbRef.value?.$el\n\n                    // Make sure second thumb is focused if\n                    // the thumbs are on top of each other\n                    // and they are both at minimum value\n                    // but only if focused from outside.\n                    if (\n                      model.value[0] === model.value[1] &&\n                      model.value[1] === min.value &&\n                      e.relatedTarget !== stopThumbRef.value?.$el\n                    ) {\n                      startThumbRef.value?.$el.blur()\n                      stopThumbRef.value?.$el.focus()\n                    }\n                  } }\n                  onBlur={ () => {\n                    blur()\n                    activeThumbRef.value = undefined\n                  } }\n                  min={ min.value }\n                  max={ model.value[1] }\n                  position={ trackStart.value }\n                >\n                  {{ 'thumb-label': slots['thumb-label'] }}\n                </VSliderThumb>\n\n                <VSliderThumb\n                  ref={ stopThumbRef }\n                  focused={ isFocused && activeThumbRef.value === stopThumbRef.value?.$el }\n                  modelValue={ model.value[1] }\n                  onUpdate:modelValue={ v => (model.value = [model.value[0], v]) }\n                  onFocus={ (e: FocusEvent) => {\n                    focus()\n                    activeThumbRef.value = stopThumbRef.value?.$el\n\n                    // Make sure first thumb is focused if\n                    // the thumbs are on top of each other\n                    // and they are both at maximum value\n                    // but only if focused from outside.\n                    if (\n                      model.value[0] === model.value[1] &&\n                      model.value[0] === max.value &&\n                      e.relatedTarget !== startThumbRef.value?.$el\n                    ) {\n                      stopThumbRef.value?.$el.blur()\n                      startThumbRef.value?.$el.focus()\n                    }\n                  } }\n                  onBlur={ () => {\n                    blur()\n                    activeThumbRef.value = undefined\n                  } }\n                  min={ model.value[0] }\n                  max={ max.value }\n                  position={ trackStop.value }\n                >\n                  {{ 'thumb-label': slots['thumb-label'] }}\n                </VSliderThumb>\n              </div>\n            ),\n          }}\n        </VInput>\n      )\n    })\n\n    return {}\n  },\n})\n\nexport type VRangeSlider = InstanceType<typeof VRangeSlider>\n"],"mappings":"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"}