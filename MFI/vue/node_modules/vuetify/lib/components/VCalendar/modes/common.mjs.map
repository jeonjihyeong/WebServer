{"version":3,"file":"common.mjs","names":["getTimestampIdentifier","MILLIS_IN_DAY","getVisuals","events","minStart","visuals","map","event","columnCount","column","left","width","sort","a","b","Math","max","startTimestampIdentifier","endTimestampIdentifier","hasOverlap","s0","e0","s1","e1","exclude","setColumnCount","groups","forEach","group","groupVisual","length","getRange","getDayRange","startIdentifier","endIdentifier","getNormalizedRange","dayStart","min","getOpenGroup","start","end","timed","i","intersected","k","groupStart","groupEnd","getOverlapGroupHandler","firstWeekday","handler","reset","day","dayEvents","weekday","visual","targetGroup","push","target"],"sources":["../../../../src/components/VCalendar/modes/common.ts"],"sourcesContent":["// @ts-nocheck\n/* eslint-disable */\n\nimport { CalendarEventParsed, CalendarEventVisual, CalendarTimestamp } from 'vuetify/types'\nimport { getTimestampIdentifier } from '../util/timestamp'\n\nconst MILLIS_IN_DAY = 86400000\n\nexport type GetRange = (event: CalendarEventParsed) => [number, number]\n\nexport function getVisuals (events: CalendarEventParsed[], minStart = 0): CalendarEventVisual[] {\n  const visuals = events.map(event => ({\n    event,\n    columnCount: 0,\n    column: 0,\n    left: 0,\n    width: 100,\n  }))\n\n  visuals.sort((a, b) => {\n    return (Math.max(minStart, a.event.startTimestampIdentifier) - Math.max(minStart, b.event.startTimestampIdentifier)) ||\n           (b.event.endTimestampIdentifier - a.event.endTimestampIdentifier)\n  })\n\n  return visuals\n}\n\nexport interface ColumnGroup {\n  start: number\n  end: number\n  visuals: CalendarEventVisual[]\n}\n\nexport function hasOverlap (s0: number, e0: number, s1: number, e1: number, exclude = true): boolean {\n  return exclude ? !(s0 >= e1 || e0 <= s1) : !(s0 > e1 || e0 < s1)\n}\n\nexport function setColumnCount (groups: ColumnGroup[]) {\n  groups.forEach(group => {\n    group.visuals.forEach(groupVisual => {\n      groupVisual.columnCount = groups.length\n    })\n  })\n}\n\nexport function getRange (event: CalendarEventParsed): [number, number] {\n  return [event.startTimestampIdentifier, event.endTimestampIdentifier]\n}\n\nexport function getDayRange (event: CalendarEventParsed): [number, number] {\n  return [event.startIdentifier, event.endIdentifier]\n}\n\nexport function getNormalizedRange (event: CalendarEventParsed, dayStart: number): [number, number] {\n  return [Math.max(dayStart, event.startTimestampIdentifier), Math.min(dayStart + MILLIS_IN_DAY, event.endTimestampIdentifier)]\n}\n\nexport function getOpenGroup (groups: ColumnGroup[], start: number, end: number, timed: boolean) {\n  for (let i = 0; i < groups.length; i++) {\n    const group = groups[i]\n    let intersected = false\n\n    if (hasOverlap(start, end, group.start, group.end, timed)) {\n      for (let k = 0; k < group.visuals.length; k++) {\n        const groupVisual = group.visuals[k]\n        const [groupStart, groupEnd] = timed ? getRange(groupVisual.event) : getDayRange(groupVisual.event)\n\n        if (hasOverlap(start, end, groupStart, groupEnd, timed)) {\n          intersected = true\n          break\n        }\n      }\n    }\n\n    if (!intersected) {\n      return i\n    }\n  }\n\n  return -1\n}\n\nexport function getOverlapGroupHandler (firstWeekday: number) {\n  const handler = {\n    groups: [] as ColumnGroup[],\n    min: -1,\n    max: -1,\n    reset: () => {\n      handler.groups = []\n      handler.min = handler.max = -1\n    },\n    getVisuals: (day: CalendarTimestamp, dayEvents: CalendarEventParsed[], timed: boolean, reset = false) => {\n      if (day.weekday === firstWeekday || reset) {\n        handler.reset()\n      }\n\n      const dayStart = getTimestampIdentifier(day)\n      const visuals = getVisuals(dayEvents, dayStart)\n\n      visuals.forEach(visual => {\n        const [start, end] = timed ? getRange(visual.event) : getDayRange(visual.event)\n\n        if (handler.groups.length > 0 && !hasOverlap(start, end, handler.min, handler.max, timed)) {\n          setColumnCount(handler.groups)\n          handler.reset()\n        }\n\n        let targetGroup = getOpenGroup(handler.groups, start, end, timed)\n\n        if (targetGroup === -1) {\n          targetGroup = handler.groups.length\n\n          handler.groups.push({ start, end, visuals: [] })\n        }\n\n        const target = handler.groups[targetGroup]\n        target.visuals.push(visual)\n        target.start = Math.min(target.start, start)\n        target.end = Math.max(target.end, end)\n\n        visual.column = targetGroup\n\n        if (handler.min === -1) {\n          handler.min = start\n          handler.max = end\n        } else {\n          handler.min = Math.min(handler.min, start)\n          handler.max = Math.max(handler.max, end)\n        }\n      })\n\n      setColumnCount(handler.groups)\n\n      if (timed) {\n        handler.reset()\n      }\n\n      return visuals\n    },\n  }\n\n  return handler\n}\n"],"mappings":"AAAA;;AACA;SAGSA,sB;AAET,MAAMC,aAAa,GAAG,QAAtB;AAIA,OAAO,SAASC,UAAT,CAAqBC,MAArB,EAAyF;EAAA,IAArCC,QAAqC,uEAA1B,CAA0B;EAC9F,MAAMC,OAAO,GAAGF,MAAM,CAACG,GAAP,CAAWC,KAAK,KAAK;IACnCA,KADmC;IAEnCC,WAAW,EAAE,CAFsB;IAGnCC,MAAM,EAAE,CAH2B;IAInCC,IAAI,EAAE,CAJ6B;IAKnCC,KAAK,EAAE;EAL4B,CAAL,CAAhB,CAAhB;EAQAN,OAAO,CAACO,IAAR,CAAa,CAACC,CAAD,EAAIC,CAAJ,KAAU;IACrB,OAAQC,IAAI,CAACC,GAAL,CAASZ,QAAT,EAAmBS,CAAC,CAACN,KAAF,CAAQU,wBAA3B,IAAuDF,IAAI,CAACC,GAAL,CAASZ,QAAT,EAAmBU,CAAC,CAACP,KAAF,CAAQU,wBAA3B,CAAxD,IACCH,CAAC,CAACP,KAAF,CAAQW,sBAAR,GAAiCL,CAAC,CAACN,KAAF,CAAQW,sBADjD;EAED,CAHD;EAKA,OAAOb,OAAP;AACD;AAQD,OAAO,SAASc,UAAT,CAAqBC,EAArB,EAAiCC,EAAjC,EAA6CC,EAA7C,EAAyDC,EAAzD,EAA8F;EAAA,IAAzBC,OAAyB,uEAAf,IAAe;EACnG,OAAOA,OAAO,GAAG,EAAEJ,EAAE,IAAIG,EAAN,IAAYF,EAAE,IAAIC,EAApB,CAAH,GAA6B,EAAEF,EAAE,GAAGG,EAAL,IAAWF,EAAE,GAAGC,EAAlB,CAA3C;AACD;AAED,OAAO,SAASG,cAAT,CAAyBC,MAAzB,EAAgD;EACrDA,MAAM,CAACC,OAAP,CAAeC,KAAK,IAAI;IACtBA,KAAK,CAACvB,OAAN,CAAcsB,OAAd,CAAsBE,WAAW,IAAI;MACnCA,WAAW,CAACrB,WAAZ,GAA0BkB,MAAM,CAACI,MAAjC;IACD,CAFD;EAGD,CAJD;AAKD;AAED,OAAO,SAASC,QAAT,CAAmBxB,KAAnB,EAAiE;EACtE,OAAO,CAACA,KAAK,CAACU,wBAAP,EAAiCV,KAAK,CAACW,sBAAvC,CAAP;AACD;AAED,OAAO,SAASc,WAAT,CAAsBzB,KAAtB,EAAoE;EACzE,OAAO,CAACA,KAAK,CAAC0B,eAAP,EAAwB1B,KAAK,CAAC2B,aAA9B,CAAP;AACD;AAED,OAAO,SAASC,kBAAT,CAA6B5B,KAA7B,EAAyD6B,QAAzD,EAA6F;EAClG,OAAO,CAACrB,IAAI,CAACC,GAAL,CAASoB,QAAT,EAAmB7B,KAAK,CAACU,wBAAzB,CAAD,EAAqDF,IAAI,CAACsB,GAAL,CAASD,QAAQ,GAAGnC,aAApB,EAAmCM,KAAK,CAACW,sBAAzC,CAArD,CAAP;AACD;AAED,OAAO,SAASoB,YAAT,CAAuBZ,MAAvB,EAA8Ca,KAA9C,EAA6DC,GAA7D,EAA0EC,KAA1E,EAA0F;EAC/F,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhB,MAAM,CAACI,MAA3B,EAAmCY,CAAC,EAApC,EAAwC;IACtC,MAAMd,KAAK,GAAGF,MAAM,CAACgB,CAAD,CAApB;IACA,IAAIC,WAAW,GAAG,KAAlB;;IAEA,IAAIxB,UAAU,CAACoB,KAAD,EAAQC,GAAR,EAAaZ,KAAK,CAACW,KAAnB,EAA0BX,KAAK,CAACY,GAAhC,EAAqCC,KAArC,CAAd,EAA2D;MACzD,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhB,KAAK,CAACvB,OAAN,CAAcyB,MAAlC,EAA0Cc,CAAC,EAA3C,EAA+C;QAC7C,MAAMf,WAAW,GAAGD,KAAK,CAACvB,OAAN,CAAcuC,CAAd,CAApB;QACA,MAAM,CAACC,UAAD,EAAaC,QAAb,IAAyBL,KAAK,GAAGV,QAAQ,CAACF,WAAW,CAACtB,KAAb,CAAX,GAAiCyB,WAAW,CAACH,WAAW,CAACtB,KAAb,CAAhF;;QAEA,IAAIY,UAAU,CAACoB,KAAD,EAAQC,GAAR,EAAaK,UAAb,EAAyBC,QAAzB,EAAmCL,KAAnC,CAAd,EAAyD;UACvDE,WAAW,GAAG,IAAd;UACA;QACD;MACF;IACF;;IAED,IAAI,CAACA,WAAL,EAAkB;MAChB,OAAOD,CAAP;IACD;EACF;;EAED,OAAO,CAAC,CAAR;AACD;AAED,OAAO,SAASK,sBAAT,CAAiCC,YAAjC,EAAuD;EAC5D,MAAMC,OAAO,GAAG;IACdvB,MAAM,EAAE,EADM;IAEdW,GAAG,EAAE,CAAC,CAFQ;IAGdrB,GAAG,EAAE,CAAC,CAHQ;IAIdkC,KAAK,EAAE,MAAM;MACXD,OAAO,CAACvB,MAAR,GAAiB,EAAjB;MACAuB,OAAO,CAACZ,GAAR,GAAcY,OAAO,CAACjC,GAAR,GAAc,CAAC,CAA7B;IACD,CAPa;IAQdd,UAAU,EAAE,UAACiD,GAAD,EAAyBC,SAAzB,EAA2DX,KAA3D,EAA6F;MAAA,IAAlBS,KAAkB,uEAAV,KAAU;;MACvG,IAAIC,GAAG,CAACE,OAAJ,KAAgBL,YAAhB,IAAgCE,KAApC,EAA2C;QACzCD,OAAO,CAACC,KAAR;MACD;;MAED,MAAMd,QAAQ,GAAGpC,sBAAsB,CAACmD,GAAD,CAAvC;MACA,MAAM9C,OAAO,GAAGH,UAAU,CAACkD,SAAD,EAAYhB,QAAZ,CAA1B;MAEA/B,OAAO,CAACsB,OAAR,CAAgB2B,MAAM,IAAI;QACxB,MAAM,CAACf,KAAD,EAAQC,GAAR,IAAeC,KAAK,GAAGV,QAAQ,CAACuB,MAAM,CAAC/C,KAAR,CAAX,GAA4ByB,WAAW,CAACsB,MAAM,CAAC/C,KAAR,CAAjE;;QAEA,IAAI0C,OAAO,CAACvB,MAAR,CAAeI,MAAf,GAAwB,CAAxB,IAA6B,CAACX,UAAU,CAACoB,KAAD,EAAQC,GAAR,EAAaS,OAAO,CAACZ,GAArB,EAA0BY,OAAO,CAACjC,GAAlC,EAAuCyB,KAAvC,CAA5C,EAA2F;UACzFhB,cAAc,CAACwB,OAAO,CAACvB,MAAT,CAAd;UACAuB,OAAO,CAACC,KAAR;QACD;;QAED,IAAIK,WAAW,GAAGjB,YAAY,CAACW,OAAO,CAACvB,MAAT,EAAiBa,KAAjB,EAAwBC,GAAxB,EAA6BC,KAA7B,CAA9B;;QAEA,IAAIc,WAAW,KAAK,CAAC,CAArB,EAAwB;UACtBA,WAAW,GAAGN,OAAO,CAACvB,MAAR,CAAeI,MAA7B;UAEAmB,OAAO,CAACvB,MAAR,CAAe8B,IAAf,CAAoB;YAAEjB,KAAF;YAASC,GAAT;YAAcnC,OAAO,EAAE;UAAvB,CAApB;QACD;;QAED,MAAMoD,MAAM,GAAGR,OAAO,CAACvB,MAAR,CAAe6B,WAAf,CAAf;QACAE,MAAM,CAACpD,OAAP,CAAemD,IAAf,CAAoBF,MAApB;QACAG,MAAM,CAAClB,KAAP,GAAexB,IAAI,CAACsB,GAAL,CAASoB,MAAM,CAAClB,KAAhB,EAAuBA,KAAvB,CAAf;QACAkB,MAAM,CAACjB,GAAP,GAAazB,IAAI,CAACC,GAAL,CAASyC,MAAM,CAACjB,GAAhB,EAAqBA,GAArB,CAAb;QAEAc,MAAM,CAAC7C,MAAP,GAAgB8C,WAAhB;;QAEA,IAAIN,OAAO,CAACZ,GAAR,KAAgB,CAAC,CAArB,EAAwB;UACtBY,OAAO,CAACZ,GAAR,GAAcE,KAAd;UACAU,OAAO,CAACjC,GAAR,GAAcwB,GAAd;QACD,CAHD,MAGO;UACLS,OAAO,CAACZ,GAAR,GAActB,IAAI,CAACsB,GAAL,CAASY,OAAO,CAACZ,GAAjB,EAAsBE,KAAtB,CAAd;UACAU,OAAO,CAACjC,GAAR,GAAcD,IAAI,CAACC,GAAL,CAASiC,OAAO,CAACjC,GAAjB,EAAsBwB,GAAtB,CAAd;QACD;MACF,CA9BD;MAgCAf,cAAc,CAACwB,OAAO,CAACvB,MAAT,CAAd;;MAEA,IAAIe,KAAJ,EAAW;QACTQ,OAAO,CAACC,KAAR;MACD;;MAED,OAAO7C,OAAP;IACD;EAvDa,CAAhB;EA0DA,OAAO4C,OAAP;AACD"}