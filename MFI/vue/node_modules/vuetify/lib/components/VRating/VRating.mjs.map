{"version":3,"file":"VRating.mjs","names":["VBtn","IconValue","makeDensityProps","makeSizeProps","makeTagProps","makeThemeProps","provideTheme","useLocale","useProxiedModel","computed","ref","createRange","genericComponent","getUid","useRender","VRating","name","props","String","itemAriaLabel","type","default","activeColor","color","clearable","Boolean","disabled","emptyIcon","fullIcon","halfIncrements","hover","length","Number","readonly","modelValue","itemLabels","Array","itemLabelPosition","validator","v","includes","ripple","emits","value","setup","slots","t","themeClasses","rating","range","increments","flatMap","hoverIndex","focusIndex","firstRef","isClicking","itemState","map","isHovering","isFilled","isHovered","isFullIcon","icon","eventState","onMouseenter","onMouseleave","onFocus","focus","onBlur","onClick","undefined","onMousedown","onMouseup","VRatingItem","index","showStar","id","replace","btnProps","density","size","tag","variant","item","createLabel","labelProps","label","hasLabels","i","Math","ceil"],"sources":["../../../src/components/VRating/VRating.tsx"],"sourcesContent":["// Styles\nimport './VRating.sass'\n\n// Components\nimport { VBtn } from '@/components/VBtn'\n\n// Composables\nimport { IconValue } from '@/composables/icons'\nimport { makeDensityProps } from '@/composables/density'\nimport { makeSizeProps } from '@/composables/size'\nimport { makeTagProps } from '@/composables/tag'\nimport { makeThemeProps, provideTheme } from '@/composables/theme'\nimport { useLocale } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, ref } from 'vue'\nimport { createRange, genericComponent, getUid, useRender } from '@/util'\n\n// Types\nimport type { MakeSlots } from '@/util'\nimport type { Prop } from 'vue'\nimport type { Variant } from '@/composables/variant'\n\ntype VRatingItemSlot = {\n  value: number\n  index: number\n  isFilled: boolean\n  isHovered: boolean\n  icon: IconValue\n  color?: string\n  props: Record<string, unknown>\n}\n\ntype VRatingItemLabelSlot = {\n  value: number\n  index: number\n  label?: string\n}\n\nexport const VRating = genericComponent<new <T>() => {\n  $slots: MakeSlots<{\n    item: [VRatingItemSlot]\n    'item-label': [VRatingItemLabelSlot]\n  }>\n}>()({\n  name: 'VRating',\n\n  props: {\n    name: String,\n    itemAriaLabel: {\n      type: String,\n      default: '$vuetify.rating.ariaLabel.item',\n    },\n    activeColor: String,\n    color: String,\n    clearable: Boolean,\n    disabled: Boolean,\n    emptyIcon: {\n      type: IconValue,\n      default: '$ratingEmpty',\n    },\n    fullIcon: {\n      type: IconValue,\n      default: '$ratingFull',\n    },\n    halfIncrements: Boolean,\n    hover: Boolean,\n    length: {\n      type: [Number, String],\n      default: 5,\n    },\n    readonly: Boolean,\n    modelValue: {\n      type: Number,\n      default: 0,\n    },\n    itemLabels: Array as Prop<string[]>,\n    itemLabelPosition: {\n      type: String,\n      default: 'top',\n      validator: (v: any) => ['top', 'bottom'].includes(v),\n    },\n    ripple: Boolean,\n\n    ...makeDensityProps(),\n    ...makeSizeProps(),\n    ...makeTagProps(),\n    ...makeThemeProps(),\n  },\n\n  emits: {\n    'update:modelValue': (value: number) => true,\n  },\n\n  setup (props, { slots }) {\n    const { t } = useLocale()\n    const { themeClasses } = provideTheme(props)\n    const rating = useProxiedModel(props, 'modelValue')\n\n    const range = computed(() => createRange(Number(props.length), 1))\n    const increments = computed(() => range.value.flatMap(v => props.halfIncrements ? [v - 0.5, v] : [v]))\n    const hoverIndex = ref(-1)\n    const focusIndex = ref(-1)\n    const firstRef = ref<HTMLElement>()\n    let isClicking = false\n\n    const itemState = computed(() => increments.value.map(value => {\n      const isHovering = props.hover && hoverIndex.value > -1\n      const isFilled = rating.value >= value\n      const isHovered = hoverIndex.value >= value\n      const isFullIcon = isHovering ? isHovered : isFilled\n      const icon = isFullIcon ? props.fullIcon : props.emptyIcon\n      const activeColor = props.activeColor ?? props.color\n      const color = (isFilled || isHovered) ? activeColor : props.color\n\n      return { isFilled, isHovered, icon, color }\n    }))\n\n    const eventState = computed(() => [0, ...increments.value].map(value => {\n      function onMouseenter () {\n        hoverIndex.value = value\n      }\n\n      function onMouseleave () {\n        hoverIndex.value = -1\n      }\n\n      function onFocus () {\n        if (value === 0 && rating.value === 0) {\n          firstRef.value?.focus()\n        } else {\n          focusIndex.value = value\n        }\n      }\n\n      function onBlur () {\n        if (!isClicking) focusIndex.value = -1\n      }\n\n      function onClick () {\n        if (props.disabled || props.readonly) return\n        rating.value = rating.value === value && props.clearable ? 0 : value\n      }\n\n      return {\n        onMouseenter: props.hover ? onMouseenter : undefined,\n        onMouseleave: props.hover ? onMouseleave : undefined,\n        onFocus,\n        onBlur,\n        onClick,\n      }\n    }))\n\n    function onMousedown () {\n      isClicking = true\n    }\n\n    function onMouseup () {\n      isClicking = false\n    }\n\n    const name = computed(() => props.name ?? `v-rating-${getUid()}`)\n\n    function VRatingItem ({ value, index, showStar = true }: { value: number, index: number, showStar?: boolean }) {\n      const { onMouseenter, onMouseleave, onFocus, onBlur, onClick } = eventState.value[index + 1]\n      const id = `${name.value}-${String(value).replace('.', '-')}`\n      const btnProps = {\n        color: itemState.value[index]?.color,\n        density: props.density,\n        disabled: props.disabled,\n        icon: itemState.value[index]?.icon,\n        ripple: props.ripple,\n        size: props.size,\n        tag: 'span',\n        variant: 'plain' as Variant,\n      }\n\n      return (\n        <>\n          <label\n            for={ id }\n            class={{\n              'v-rating__item--half': props.halfIncrements && value % 1 > 0,\n              'v-rating__item--full': props.halfIncrements && value % 1 === 0,\n            }}\n            onMousedown={ onMousedown }\n            onMouseup={ onMouseup }\n            onMouseenter={ onMouseenter }\n            onMouseleave={ onMouseleave }\n          >\n            <span class=\"v-rating__hidden\">{ t(props.itemAriaLabel, value, props.length) }</span>\n            {\n              !showStar ? undefined\n              : slots.item ? slots.item({\n                ...itemState.value[index],\n                props: btnProps,\n                value,\n                index,\n              })\n              : (\n                <VBtn { ...btnProps } />\n              )\n            }\n          </label>\n\n          <input\n            class=\"v-rating__hidden\"\n            name={ name.value }\n            id={ id }\n            type=\"radio\"\n            value={ value }\n            checked={ rating.value === value }\n            onClick={ onClick }\n            onFocus={ onFocus }\n            onBlur={ onBlur }\n            ref={ index === 0 ? firstRef : undefined }\n            readonly={ props.readonly }\n            disabled={ props.disabled }\n          />\n        </>\n      )\n    }\n\n    function createLabel (labelProps: { value: number, index: number, label?: string }) {\n      if (slots['item-label']) return slots['item-label'](labelProps)\n\n      if (labelProps.label) return <span>{ labelProps.label }</span>\n\n      return <span>&nbsp;</span>\n    }\n\n    useRender(() => {\n      const hasLabels = !!props.itemLabels?.length || slots['item-label']\n\n      return (\n        <props.tag\n          class={[\n            'v-rating',\n            {\n              'v-rating--hover': props.hover,\n              'v-rating--readonly': props.readonly,\n            },\n            themeClasses.value,\n          ]}\n        >\n          <VRatingItem value={ 0 } index={ -1 } showStar={ false } />\n\n          { range.value.map((value, i) => (\n            <div class=\"v-rating__wrapper\">\n              {\n                hasLabels && props.itemLabelPosition === 'top'\n                  ? createLabel({ value, index: i, label: props.itemLabels?.[i] })\n                  : undefined\n              }\n              <div\n                class={[\n                  'v-rating__item',\n                  {\n                    'v-rating__item--focused': Math.ceil(focusIndex.value) === value,\n                  },\n                ]}\n              >\n                { props.halfIncrements ? (\n                  <>\n                    <VRatingItem value={ value - 0.5 } index={ i * 2 } />\n                    <VRatingItem value={ value } index={ (i * 2) + 1 } />\n                  </>\n                ) : (\n                  <VRatingItem value={ value } index={ i } />\n                ) }\n              </div>\n              {\n                hasLabels && props.itemLabelPosition === 'bottom'\n                  ? createLabel({ value, index: i, label: props.itemLabels?.[i] })\n                  : undefined\n              }\n            </div>\n          )) }\n        </props.tag>\n      )\n    })\n\n    return {}\n  },\n})\n\nexport type VRating = InstanceType<typeof VRating>\n"],"mappings":"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"}