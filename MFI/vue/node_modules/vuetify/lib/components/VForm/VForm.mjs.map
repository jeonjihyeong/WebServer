{"version":3,"file":"VForm.mjs","names":["createForm","makeFormProps","forwardRefs","ref","defineComponent","useRender","VForm","name","props","emits","val","submit","e","setup","slots","emit","form","formRef","onReset","preventDefault","reset","onSubmit","_e","ready","validate","then","bind","catch","finally","defaultPrevented","valid","value","default"],"sources":["../../../src/components/VForm/VForm.tsx"],"sourcesContent":["// Composables\nimport { createForm, makeFormProps } from '@/composables/form'\nimport { forwardRefs } from '@/composables/forwardRefs'\n\n// Utilities\nimport { ref } from 'vue'\nimport { defineComponent, useRender } from '@/util'\n\n// Types\nimport type { SubmitEventPromise } from '@/composables/form'\n\nexport const VForm = defineComponent({\n  name: 'VForm',\n\n  props: {\n    ...makeFormProps(),\n  },\n\n  emits: {\n    'update:modelValue': (val: boolean | null) => true,\n    submit: (e: SubmitEventPromise) => true,\n  },\n\n  setup (props, { slots, emit }) {\n    const form = createForm(props)\n    const formRef = ref<HTMLFormElement>()\n\n    function onReset (e: Event) {\n      e.preventDefault()\n      form.reset()\n    }\n\n    function onSubmit (_e: Event) {\n      const e = _e as SubmitEventPromise\n\n      const ready = form.validate()\n      e.then = ready.then.bind(ready)\n      e.catch = ready.catch.bind(ready)\n      e.finally = ready.finally.bind(ready)\n\n      emit('submit', e)\n\n      if (!e.defaultPrevented) {\n        ready.then(({ valid }) => {\n          if (valid) {\n            formRef.value?.submit()\n          }\n        })\n      }\n\n      e.preventDefault()\n    }\n\n    useRender(() => ((\n      <form\n        ref={ formRef }\n        class=\"v-form\"\n        novalidate\n        onReset={ onReset }\n        onSubmit={ onSubmit }\n      >\n        { slots.default?.(form) }\n      </form>\n    )))\n\n    return forwardRefs(form, formRef)\n  },\n})\n\nexport type VForm = InstanceType<typeof VForm>\n"],"mappings":";AAAA;SACSA,U,EAAYC,a;SACZC,W,6CAET;;AACA,SAASC,GAAT,QAAoB,KAApB;SACSC,e,EAAiBC,S,gCAE1B;;AAGA,OAAO,MAAMC,KAAK,GAAGF,eAAe,CAAC;EACnCG,IAAI,EAAE,OAD6B;EAGnCC,KAAK,EAAE,EACL,GAAGP,aAAa;EADX,CAH4B;EAOnCQ,KAAK,EAAE;IACL,qBAAsBC,GAAD,IAAyB,IADzC;IAELC,MAAM,EAAGC,CAAD,IAA2B;EAF9B,CAP4B;;EAYnCC,KAAK,CAAEL,KAAF,QAA0B;IAAA,IAAjB;MAAEM,KAAF;MAASC;IAAT,CAAiB;IAC7B,MAAMC,IAAI,GAAGhB,UAAU,CAACQ,KAAD,CAAvB;IACA,MAAMS,OAAO,GAAGd,GAAG,EAAnB;;IAEA,SAASe,OAAT,CAAkBN,CAAlB,EAA4B;MAC1BA,CAAC,CAACO,cAAF;MACAH,IAAI,CAACI,KAAL;IACD;;IAED,SAASC,QAAT,CAAmBC,EAAnB,EAA8B;MAC5B,MAAMV,CAAC,GAAGU,EAAV;MAEA,MAAMC,KAAK,GAAGP,IAAI,CAACQ,QAAL,EAAd;MACAZ,CAAC,CAACa,IAAF,GAASF,KAAK,CAACE,IAAN,CAAWC,IAAX,CAAgBH,KAAhB,CAAT;MACAX,CAAC,CAACe,KAAF,GAAUJ,KAAK,CAACI,KAAN,CAAYD,IAAZ,CAAiBH,KAAjB,CAAV;MACAX,CAAC,CAACgB,OAAF,GAAYL,KAAK,CAACK,OAAN,CAAcF,IAAd,CAAmBH,KAAnB,CAAZ;MAEAR,IAAI,CAAC,QAAD,EAAWH,CAAX,CAAJ;;MAEA,IAAI,CAACA,CAAC,CAACiB,gBAAP,EAAyB;QACvBN,KAAK,CAACE,IAAN,CAAW,SAAe;UAAA,IAAd;YAAEK;UAAF,CAAc;;UACxB,IAAIA,KAAJ,EAAW;YAAA;;YACT,kBAAAb,OAAO,CAACc,KAAR,oCAAepB,MAAf;UACD;QACF,CAJD;MAKD;;MAEDC,CAAC,CAACO,cAAF;IACD;;IAEDd,SAAS,CAAC;MAAA;;MAAA;QAAA,OAEAY,OAFA;QAAA,SAGA,QAHA;QAAA;QAAA,WAKIC,OALJ;QAAA,YAMKG;MANL,sBAQJP,KAAK,CAACkB,OARF,qBAQJ,oBAAAlB,KAAK,EAAWE,IAAX,CARD;IAAA,CAAD,CAAT;IAYA,OAAOd,WAAW,CAACc,IAAD,EAAOC,OAAP,CAAlB;EACD;;AAvDkC,CAAD,CAA7B"}