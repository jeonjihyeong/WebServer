{"version":3,"file":"index.mjs","names":["mounted","el","binding","modifiers","value","once","immediate","modifierKeys","defaultValue","Object","keys","length","handler","options","attributes","attr","characterData","char","childList","child","subtree","sub","observer","MutationObserver","mutations","unmounted","_mutate","instance","$","uid","observe","disconnect","Mutate"],"sources":["../../../src/directives/mutate/index.ts"],"sourcesContent":["// Types\nimport type { DirectiveBinding, ObjectDirective } from 'vue'\nimport type { MutationOptions } from '@/composables/mutationObserver'\n\nexport interface MutationDirectiveBinding extends Omit<DirectiveBinding, 'modifiers' | 'value'> {\n  value: MutationCallback | { handler: MutationCallback, options?: MutationObserverInit }\n  modifiers: MutationOptions\n}\n\nfunction mounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  const modifiers = binding.modifiers || {}\n  const value = binding.value\n  const { once, immediate, ...modifierKeys } = modifiers\n  const defaultValue = !Object.keys(modifierKeys).length\n\n  const { handler, options } = typeof value === 'object'\n    ? value\n    : {\n      handler: value,\n      options: {\n        attributes: modifierKeys?.attr ?? defaultValue,\n        characterData: modifierKeys?.char ?? defaultValue,\n        childList: modifierKeys?.child ?? defaultValue,\n        subtree: modifierKeys?.sub ?? defaultValue,\n      },\n    }\n\n  const observer = new MutationObserver((\n    mutations: MutationRecord[] = [],\n    observer: MutationObserver\n  ) => {\n    handler?.(mutations, observer)\n\n    if (once) unmounted(el, binding)\n  })\n\n  if (immediate) handler?.([], observer)\n\n  el._mutate = Object(el._mutate)\n  el._mutate![binding.instance!.$.uid] = { observer }\n\n  observer.observe(el, options)\n}\n\nfunction unmounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  if (!el._mutate?.[binding.instance!.$.uid]) return\n\n  el._mutate[binding.instance!.$.uid]!.observer.disconnect()\n  delete el._mutate[binding.instance!.$.uid]\n}\n\nexport const Mutate: ObjectDirective<HTMLElement> = {\n  mounted,\n  unmounted,\n}\n\nexport default Mutate\n"],"mappings":"AAAA;AASA,SAASA,OAAT,CAAkBC,EAAlB,EAAmCC,OAAnC,EAAsE;EAAA;;EACpE,MAAMC,SAAS,GAAGD,OAAO,CAACC,SAAR,IAAqB,EAAvC;EACA,MAAMC,KAAK,GAAGF,OAAO,CAACE,KAAtB;EACA,MAAM;IAAEC,IAAF;IAAQC,SAAR;IAAmB,GAAGC;EAAtB,IAAuCJ,SAA7C;EACA,MAAMK,YAAY,GAAG,CAACC,MAAM,CAACC,IAAP,CAAYH,YAAZ,EAA0BI,MAAhD;EAEA,MAAM;IAAEC,OAAF;IAAWC;EAAX,IAAuB,OAAOT,KAAP,KAAiB,QAAjB,GACzBA,KADyB,GAEzB;IACAQ,OAAO,EAAER,KADT;IAEAS,OAAO,EAAE;MACPC,UAAU,wBAAEP,YAAF,oBAAEA,YAAY,CAAEQ,IAAhB,iCAAwBP,YAD3B;MAEPQ,aAAa,wBAAET,YAAF,oBAAEA,YAAY,CAAEU,IAAhB,iCAAwBT,YAF9B;MAGPU,SAAS,yBAAEX,YAAF,oBAAEA,YAAY,CAAEY,KAAhB,kCAAyBX,YAH3B;MAIPY,OAAO,uBAAEb,YAAF,oBAAEA,YAAY,CAAEc,GAAhB,gCAAuBb;IAJvB;EAFT,CAFJ;EAYA,MAAMc,QAAQ,GAAG,IAAIC,gBAAJ,CAAqB,YAGjC;IAAA,IAFHC,SAEG,uEAF2B,EAE3B;IAAA,IADHF,QACG;IACHV,OAAO,QAAP,YAAAA,OAAO,CAAGY,SAAH,EAAcF,QAAd,CAAP;IAEA,IAAIjB,IAAJ,EAAUoB,SAAS,CAACxB,EAAD,EAAKC,OAAL,CAAT;EACX,CAPgB,CAAjB;EASA,IAAII,SAAJ,EAAeM,OAAO,QAAP,YAAAA,OAAO,CAAG,EAAH,EAAOU,QAAP,CAAP;EAEfrB,EAAE,CAACyB,OAAH,GAAajB,MAAM,CAACR,EAAE,CAACyB,OAAJ,CAAnB;EACAzB,EAAE,CAACyB,OAAH,CAAYxB,OAAO,CAACyB,QAAR,CAAkBC,CAAlB,CAAoBC,GAAhC,IAAuC;IAAEP;EAAF,CAAvC;EAEAA,QAAQ,CAACQ,OAAT,CAAiB7B,EAAjB,EAAqBY,OAArB;AACD;;AAED,SAASY,SAAT,CAAoBxB,EAApB,EAAqCC,OAArC,EAAwE;EAAA;;EACtE,IAAI,iBAACD,EAAE,CAACyB,OAAJ,aAAC,YAAaxB,OAAO,CAACyB,QAAR,CAAkBC,CAAlB,CAAoBC,GAAjC,CAAD,CAAJ,EAA4C;;EAE5C5B,EAAE,CAACyB,OAAH,CAAWxB,OAAO,CAACyB,QAAR,CAAkBC,CAAlB,CAAoBC,GAA/B,EAAqCP,QAArC,CAA8CS,UAA9C;;EACA,OAAO9B,EAAE,CAACyB,OAAH,CAAWxB,OAAO,CAACyB,QAAR,CAAkBC,CAAlB,CAAoBC,GAA/B,CAAP;AACD;;AAED,OAAO,MAAMG,MAAoC,GAAG;EAClDhC,OADkD;EAElDyB;AAFkD,CAA7C;AAKP,eAAeO,MAAf"}